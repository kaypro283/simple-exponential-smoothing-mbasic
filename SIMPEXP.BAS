10 CLEAR
20 REM *** PROGRAM BY CHRISTOPHER D. VAN DER KAAY, PH.D. ***
30 REM *** SIMPLE EXPONENTIAL SMOOTHING FORECASTING TOOL (MBASIC-80) ***
40 REM *** REM - UP TO 100 DATA POINTS; FORECAST HORIZON N+H ≤ 100 ***
50 REM *** OPTIMIZES SMOOTHING PARAMETER ALPHA BY BRUTE-FORCE SEARCH ***
60 REM *** COMPUTES AND DISPLAYS STATISTICAL ACCURACY MEASURES ***
70 PRINT STRING$(79, "=")
80 PRINT TAB(20); "WELCOME TO THE TIME-SERIES FORECASTING TOOL"
90 PRINT STRING$(79, "=")
100 PRINT
110 PRINT TAB(10); "SIMPLE EXPONENTIAL SMOOTHING METHOD FOR TIME-SERIES FORECASTING"
120 PRINT TAB(10); STRING$(60, "-")
130 PRINT
140 PRINT TAB(5); "THIS PROGRAM USES THE SIMPLE EXPONENTIAL SMOOTHING METHOD"
150 PRINT TAB(5); "TO FORECAST FUTURE VALUES IN A TIME SERIES BASED ON HISTORICAL"
160 PRINT TAB(5); "DATA POINTS. IT CALCULATES FORECASTED VALUES BY AUTOMATICALLY"
170 PRINT TAB(5); "DETERMINING THE OPTIMAL ALPHA VALUE THAT MINIMIZES THE FORECAST ERROR"
180 PRINT TAB(5); "AND PROVIDES VARIOUS STATISTICAL MEASURES OF FORECAST ACCURACY."
190 PRINT TAB(5); "THIS METHOD IS USEFUL FOR SERIES WITH NO TREND OR SEASONAL PATTERN."
200 PRINT
210 PRINT STRING$(79, "-")
220 PROMPT$ = "LEARN ABOUT THE FORECAST ACCURACY METRICS BEFORE PROCEEDING? (Y/N): "
230 GOSUB 4120
240 IF RESP$ = "Y" THEN GOSUB 1930
250 PRINT STRING$(79, "-")
260 PRINT
270 PRINT "ENTER THE HISTORICAL DATA POINTS AND FORECAST HORIZON."
280 PRINT "THE PROGRAM WILL AUTOMATICALLY CALCULATE THE OPTIMAL ALPHA VALUE"
290 PRINT "THAT MINIMIZES THE FORECAST ERROR."
300 PRINT
310 PRINT STRING$(79, "=")
320 PRINT
330 DIM Y(100), F(100), S(100)   ' Y() = INPUT DATA; F() = FORECASTS; S() = SMOOTHED VALUES
340 DIM U(100), L(100)  ' U() AND L() FOR UPPER/LOWER CONFIDENCE INTERVALS; ALL ARRAYS INDEX 1..N+H
350 INPUT "ENTER NUMBER OF HISTORICAL DATA POINTS: "; N
360 IF N < 2 OR N > 100 THEN PRINT "INVALID INPUT. ENTER AN INTEGER BETWEEN 2 AND 100.": GOTO 350
370 AVE = 0
380 FOR I = 1 TO N
390 INPUT "ENTER DATA POINT "; A$   ' ACCEPT INPUT AS STRING TO VALIDATE NUMERICS
400 Y(I) = VAL(A$)   ' CONVERT TO NUMERIC VALUE
410 IF Y(I) = 0 AND A$ <> "0" THEN PRINT "INVALID INPUT. ENTER A NUMERICAL VALUE.": GOTO 390   ' ALLOW "0" ONLY IF INPUT IS STRING "0"
420 AVE = AVE + Y(I)
430 NEXT I
440 PRINT
450 GOSUB 4220 ' *** EXPLANATORY MESSAGE ABOUT STATIONARITY TEST ***
460 PROMPT$ = "VIEW THE FIRST-DIFFERENCED SERIES FOR STATIONARITY CHECK? (Y/N): "
470 GOSUB 4120
480 IF RESP$ = "Y" THEN GOSUB 3180
490 PROMPT$ = "COMPARE MEANS AND VARIANCES OF THE FIRST AND SECOND HALVES? (Y/N): "
500 GOSUB 4120
510 IF RESP$ = "Y" THEN GOSUB 3370
520 AVE = AVE / N
530 INPUT "ENTER FORECAST HORIZON: "; H
540 IF H <= 0 THEN PRINT "INVALID INPUT. ENTER A POSITIVE INTEGER.": GOTO 530
550 IF N + H > 100 THEN PRINT "N + H EXCEEDS 100. REDUCE FORECAST HORIZON.": GOTO 530
560 PRINT
570 INPUT "ENTER STEP SIZE (BETWEEN 0.001 AND 0.1): "; ALPHASTEP
580 IF ALPHASTEP <= 0 OR ALPHASTEP > .1 THEN PRINT "INVALID INPUT. ENTER A VALUE BETWEEN 0.001 AND 0.1.": GOTO 570
590 PRINT "CALCULATING OPTIMAL ALPHA VALUE..."
600 PRINT "USING STEP SIZE OF "; ALPHASTEP; " FOR ALPHA SEARCH..."
610 TSS = 0
620 FOR I = 1 TO N
630 TSS = TSS + (Y(I) - AVE) ^ 2
640 NEXT I
650 DIM TEMPS(100), TEMPF(100)
660 BALPHA = 0
670 MINMSE = 1E+30
680 FOR ALPHA = ALPHASTEP TO .99 STEP ALPHASTEP  ' BRUTE-FORCE GRID SEARCH FOR ALPHA IN [ALPHASTEP, 0.99]
690 TEMPS(1) = Y(1)
700 TEMPF(1) = Y(1)
710 SSE = 0
720 FOR I = 2 TO N   ' LOOP OVER DATA TO COMPUTE MSE FOR CURRENT ALPHA
730 TEMPS(I) = ALPHA * Y(I) + (1 - ALPHA) * TEMPS(I-1)
740 TEMPF(I) = TEMPS(I-1)
750 SSE = SSE + (Y(I) - TEMPF(I)) ^ 2
760 NEXT I
770 MSE = SSE / N
780 PRINT "ALPHA = "; ALPHA; " MSE = "; MSE  'PRINT ALPHA AND MSE
790 IF MSE < MINMSE THEN GOTO 810    ' KEEP MINIMUM MSE AND CORRESPONDING ALPHA
800 GOTO 830
810 MINMSE = MSE
820 BALPHA = ALPHA
830 NEXT ALPHA
840 ALPHA = BALPHA
850 PRINT CHR$(26):PRINT "OPTIMAL ALPHA VALUE IS: "; ALPHA
860 PRINT
870 INPUT "PRESS ANY KEY TO CONTINUE..."; DUMMY$
880 PRINT
890 S(1) = Y(1)
900 F(1) = Y(1)
910 SSE = 0
920 MAPE = 0
930 MAPECOUNT = 0
940 FOR I = 2 TO N
950 S(I) = ALPHA * Y(I) + (1 - ALPHA) * S(I-1)   ' COMPUTE SMOOTHED VALUE FOR PERIOD I
960 F(I) = S(I-1)   ' FORECAST FOR I IS PREVIOUS SMOOTHED VALUE
970 SSE = SSE + (Y(I) - F(I)) ^ 2
980 IF Y(I) <> 0 THEN GOTO 1000   ' ONLY CALCULATE MAPE IF ACTUAL DOES NOT EQUAL 0 TO AVOID DIVISION BY ZERO
990 GOTO 1020
1000 MAPE = MAPE + ABS((Y(I) - F(I)) / Y(I))
1010 MAPECOUNT = MAPECOUNT + 1
1020 NEXT I
1030 S(N+1) = ALPHA * Y(N) + (1 - ALPHA) * S(N)
1040 F(N+1) = S(N)
1050 FOR I = N+2 TO N+H
1060 S(I) = ALPHA * F(I-1) + (1 - ALPHA) * S(I-1)
1070 F(I) = S(I-1)
1080 NEXT I
1090 REM *** COMPUTE FORECAST INTERVALS ***
1100 GOSUB 3970
1110 SSE = SSE + (Y(N+1) - F(N+1)) ^ 2
1120 MSE = SSE / N
1130 MAE = 0
1140 COUNT = 0
1150 FOR I = 2 TO N
1160 MAE = MAE + ABS(Y(I) - F(I))
1170 COUNT = COUNT + 1
1180 NEXT I
1190 MAE = MAE / COUNT
1200 IF MAPECOUNT > 0 THEN MAPE = MAPE / MAPECOUNT * 100 ELSE MAPE = -1
1210 SMAPE = 0
1220 SMAPECOUNT = 0
1230 FOR I = 2 TO N
1240 NUM = ABS(Y(I) - F(I))
1250 DEN = ABS(Y(I)) + ABS(F(I))
1260 IF DEN = 0 THEN GOTO 1290   ' PREVENT DIVISION BY ZERO IF BOTH ACTUAL AND FORECAST ARE ZERO
1270 SMAPE = SMAPE + (NUM / (DEN / 2))
1280 SMAPECOUNT = SMAPECOUNT + 1
1290 NEXT I
1300 IF SMAPECOUNT > 0 THEN SMAPE = 100 * SMAPE / SMAPECOUNT ELSE SMAPE = -1
1310 PRINT CHR$(7):PRINT "FORECASTING RESULTS:"
1320 PRINT "============================================================"
1330 LINES = 0
1340 FOR I = 1 TO H
1350 PRINT "PERIOD " I;
1360 PRINT " : FORECAST = " F(N+I)
1370 PRINT "   LOWER 95% = " L(N+I)
1380 PRINT "   UPPER 95% = " U(N+I)
1390 PRINT
1400 LINES = LINES + 4
1410 IF LINES >= 15 THEN INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$: PRINT CHR$(26): LINES = 0   ' PAUSE AFTER 15 LINES
1420 NEXT I
1430 PRINT "============================================================"
1440 INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$
1450 PRINT
1460 PRINT "OPTIMAL ALPHA VALUE: "; ALPHA
1470 PRINT "MEAN ABSOLUTE ERROR (MAE): "; MAE
1480 PRINT "MEAN SQUARED ERROR (MSE): "; MSE
1490 PRINT "ROOT MEAN SQUARED ERROR (RMSE): "; (MSE ^ .5)
1500 PRINT "MEAN ABSOLUTE PERCENTAGE ERROR (MAPE): "; MAPE; "%"
1510 PRINT
1520 PRINT "SYMMETRIC MEAN ABSOLUTE PERCENTAGE ERROR (SMAPE): "; SMAPE; "%"
1530 REM *** DISPLAY MAPE THRESHOLDS AND INTERPRETATION ***
1540 PRINT "MAPE INTERPRETATION THRESHOLDS:"
1550 PRINT "-----------------------------------------"
1560 PRINT "MAPE < 10%           : HIGHLY ACCURATE FORECASTING"
1570 PRINT "10% <= MAPE < 20%    : GOOD FORECASTING"
1580 PRINT "20% <= MAPE < 50%    : REASONABLE FORECASTING"
1590 PRINT "MAPE >= 50%          : INACCURATE FORECASTING"
1600 PRINT "-----------------------------------------"
1610 PRINT
1620 REM *** INTERPRETATION OF MAPE ***
1630 IF MAPE <= 10 THEN GOTO 1700
1640 IF MAPE >= 10 AND MAPE <= 20 THEN GOTO 1690
1650 IF MAPE >= 20 AND MAPE < 50 THEN GOTO 1680
1660 IF MAPE >= 50 THEN GOTO 1670
1670 PRINT "INTERPRETATION: INACCURATE FORECASTING" : GOTO 1710
1680 PRINT "INTERPRETATION: REASONABLE FORECASTING" : GOTO 1710
1690 PRINT "INTERPRETATION: GOOD FORECASTING" : GOTO 1710
1700 PRINT "INTERPRETATION: HIGHLY ACCURATE FORECASTING"
1710 PRINT
1720 GOSUB 2060
1730 PRINT
1740 PRINT "(R)ESTART, (S)HOW RESULTS, (V)IEW PLOT, (Q) PRINT PLOT, (P)RINT REPORT, OR (E)ND"
1750 INPUT "(R/S/V/Q/P/E): "; R$
1760 IF R$ = "" THEN PRINT "ENTER R, S, V, Q, P, OR E.": GOTO 1740
1770 R$ = LEFT$(R$,1)
1780 IF R$ = "R" THEN R$ = "R"
1790 IF R$ = "S" THEN R$ = "S"
1800 IF R$ = "E" THEN R$ = "E"
1810 IF R$ = "V" THEN R$ = "V"
1820 IF R$ = "Q" THEN R$ = "Q"
1830 IF R$ = "P" THEN R$ = "P"
1840 IF R$ = "R" THEN GOTO 10
1850 IF R$ = "S" THEN GOTO 850
1860 IF R$ = "V" THEN GOSUB 2060 : GOTO 1740
1870 IF R$ = "Q" THEN GOSUB 4690 : GOTO 1740
1880 IF R$ = "P" THEN GOSUB 4430 : GOTO 1740
1890 IF R$ = "E" THEN GOTO 1910
1900 PRINT "INVALID INPUT. ENTER R, S, V, Q, P, OR E.": GOTO 1750
1910 PRINT CHR$(7):PRINT "THANK YOU FOR USING THE TIME-SERIES FORECASTING TOOL!"
1920 END
1930 REM *** EXPLANATION SUBROUTINE ***
1940 PRINT CHR$(26)
1950 PRINT STRING$(79, "=")
1960 PRINT TAB(22); "***** FORECAST ACCURACY METRICS *****"
1970 PRINT STRING$(79, "=")
1980 GOSUB 2430 ' MAE
1990 GOSUB 2590 ' MSE
2000 GOSUB 2740 ' RMSE
2010 GOSUB 2890 ' MAPE
2020 PRINT
2030 RETURN
2040 PRINT
2050 RETURN
2060 REM *** PLOT SUBROUTINE ***
2070 PROMPT$ = "PLOT THE DATA? (Y/N): "
2080 GOSUB 4120
2090 IF RESP$ <> "Y" THEN RETURN
2100 REM *** DETERMINE Y-AXIS RANGE ***
2110 MAXY = -1E+30
2120 MINY = 1E+30
2130 FOR I = 1 TO N
2140 IF Y(I) > MAXY THEN MAXY = Y(I)
2150 IF Y(I) < MINY THEN MINY = Y(I)
2160 NEXT I
2170 FOR I = 1 TO H
2180 IF F(N+I) > MAXY THEN MAXY = F(N+I)
2190 IF F(N+I) < MINY THEN MINY = F(N+I)
2200 NEXT I
2210 RANGEY = MAXY - MINY
2220 IF RANGEY = 0 THEN RANGEY = 1
2230 REM *** CALCULATE SCALING ***
2240 MAXDISP = 13
2250 TOTALPTS = N + H
2260 SCALEF = INT(TOTALPTS / MAXDISP)
2270 IF SCALEF < 1 THEN SCALEF = 1
2280 PRINT CHR$(26)
2290 PRINT "PERIOD"; TAB(12); "PLOT"
2300 PRINT STRING$(60, "-")
2310 FOR K = 1 TO TOTALPTS STEP SCALEF
2320 IF K <= N THEN GOTO 2360
2330 PLOTV = F(K)
2340 SYMBOL$ = "P"
2350 GOTO 2380
2360 PLOTV = Y(K)
2370 SYMBOL$ = "*"
2380 PLOTPOS = INT((PLOTV - MINY) / RANGEY * 45) + 12
2390 PRINT K; TAB(PLOTPOS); SYMBOL$
2400 NEXT K
2410 PRINT STRING$(60, "=")
2420 RETURN
2430 REM *** MAE (MEAN ABSOLUTE ERROR) EXPLANATION ***
2440 PRINT 
2450 PRINT " MAE (MEAN ABSOLUTE ERROR)"
2460 PRINT STRING$(79, "-")
2470 PRINT " THE MAE MEASURES THE AVERAGE MAGNITUDE OF THE"
2480 PRINT " ERRORS IN A SET OF FORECASTS, WITHOUT CONSIDERING"
2490 PRINT " THEIR DIRECTION." 
2500 PRINT
2510 PRINT " USAGE: MAE IS USED TO UNDERSTAND THE AVERAGE"
2520 PRINT " ERROR MAGNITUDE. LOWER MAE VALUES INDICATE BETTER"
2530 PRINT " ACCURACY."
2540 PRINT STRING$(79, "-")
2550 PRINT STRING$(79, "=")
2560 PRINT
2570 INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$
2580 RETURN
2590 REM *** MSE (MEAN SQUARED ERROR) EXPLANATION ***
2600 PRINT 
2610 PRINT " MSE (MEAN SQUARED ERROR)"
2620 PRINT STRING$(79, "-")
2630 PRINT " THE MSE MEASURES THE AVERAGE OF THE SQUARES OF"
2640 PRINT " THE ERRORS."
2650 PRINT
2660 PRINT " USAGE: MSE PENALIZES LARGER ERRORS MORE THAN"
2670 PRINT " SMALLER ONES, MAKING IT USEFUL FOR IDENTIFYING"
2680 PRINT " MODELS THAT NEED TO MINIMIZE LARGE ERRORS."
2690 PRINT STRING$(79, "-")
2700 PRINT STRING$(79, "=")
2710 PRINT
2720 INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$
2730 RETURN
2740 REM *** RMSE (ROOT MEAN SQUARED ERROR) EXPLANATION ***
2750 PRINT 
2760 PRINT " RMSE (ROOT MEAN SQUARED ERROR)"
2770 PRINT STRING$(79, "-")
2780 PRINT " THE RMSE IS THE SQUARE ROOT OF THE AVERAGE OF"
2790 PRINT " THE SQUARED ERRORS."
2800 PRINT
2810 PRINT " USAGE: RMSE PROVIDES A MEASURE OF THE SPREAD OF"
2820 PRINT " THE ERRORS IN THE SAME UNITS AS THE DATA, MAKING"
2830 PRINT " IT EASIER TO INTERPRET."
2840 PRINT STRING$(79, "-")
2850 PRINT STRING$(79, "=")
2860 PRINT
2870 INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$
2880 RETURN
2890 REM *** MAPE (MEAN ABSOLUTE PERCENTAGE ERROR) EXPLANATION ***
2900 PRINT 
2910 PRINT " MAPE (MEAN ABSOLUTE PERCENTAGE ERROR)"
2920 PRINT STRING$(79, "-")
2930 PRINT " THE MAPE MEASURES THE AVERAGE MAGNITUDE OF THE"
2940 PRINT " ERRORS AS A PERCENTAGE OF THE ACTUAL VALUES."
2950 PRINT
2960 PRINT " USAGE: MAPE NORMALIZES THE ERRORS AS PERCENTAGES,"
2970 PRINT " FACILITATING COMPARISONS ACROSS DIFFERENT SCALES."
2980 PRINT STRING$(79, "-")
2990 PRINT STRING$(79, "=")
3000 PRINT
3010 INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$
3020 REM *** SMAPE (SYMMETRIC MEAN ABSOLUTE PERCENTAGE ERROR) EXPLANATION ***
3030 PRINT 
3040 PRINT " SMAPE (SYMMETRIC MEAN ABSOLUTE PERCENTAGE ERROR)"
3050 PRINT STRING$(79, "-")
3060 PRINT " THE SMAPE IS A MODIFICATION OF MAPE THAT IS SYMMETRIC,"
3070 PRINT " MEANING IT TREATS OVER- AND UNDER-FORECASTS EQUALLY AND"
3080 PRINT " HANDLES ZERO OR NEAR-ZERO ACTUAL VALUES BETTER."
3090 PRINT
3100 RETURN
3110 PRINT " USAGE: SMAPE IS USEFUL FOR TIME SERIES WHERE ACTUALS"
3120 PRINT " CAN BE ZERO OR CLOSE TO ZERO. IT PROVIDES A PERCENTAGE"
3130 PRINT " ERROR THAT IS BOUNDED BETWEEN 0% AND 200%."
3140 PRINT STRING$(79, "-")
3150 PRINT STRING$(79, "=")
3160 PRINT
3170 INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$
3180 REM *** FIRST-DIFFERENCING SUBROUTINE WITH PAGING ***
3190 REM *** DISPLAYS THE FIRST-DIFFERENCED TIME SERIES (Y(I) - Y(I-1)), PAUSING EVERY 16 LINES ***
3200 PRINT CHR$(26)
3210 PRINT "FIRST-DIFFERENCED SERIES"
3220 PRINT STRING$(60, "-")
3230 LINES = 0
3240 FOR I = 2 TO N
3250 D = Y(I) - Y(I - 1)
3260 PRINT "DIFF("; I; ") = "; D
3270 LINES = LINES + 1
3280 IF LINES = 16 THEN GOSUB 3330: LINES = 0
3290 NEXT I
3300 PRINT STRING$(60, "-")
3310 IF LINES > 0 THEN GOSUB 3330
3320 RETURN
3330 REM *** PAUSE FOR PAGINATION ***
3340 INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$
3350 PRINT CHR$(26)
3360 RETURN
3370 REM *** MEAN AND VARIANCE STABILITY CHECK ***
3380 REM *** COMPUTE MIDPOINT OF SERIES ***
3390 MID = INT(N / 2)
3400 SUM1 = 0: SUM2 = 0
3410 FOR I = 1 TO MID
3420 SUM1 = SUM1 + Y(I)
3430 NEXT I
3440 FOR I = MID + 1 TO N
3450 SUM2 = SUM2 + Y(I)
3460 NEXT I
3470 MEAN1 = SUM1 / MID
3480 MEAN2 = SUM2 / (N - MID)
3490 REM *** NOW COMPUTE VARIANCES ***
3500 VAR1 = 0: VAR2 = 0
3510 FOR I = 1 TO MID
3520 VAR1 = VAR1 + (Y(I) - MEAN1) ^ 2
3530 NEXT I
3540 VAR1 = VAR1 / MID
3550 FOR I = MID + 1 TO N
3560 VAR2 = VAR2 + (Y(I) - MEAN2) ^ 2
3570 NEXT I
3580 VAR2 = VAR2 / (N - MID)
3590 REM *** PRINT RESULTS ***
3600 PRINT CHR$(26)
3610 PRINT "STATIONARITY CHECK: MEAN AND VARIANCE COMPARISON"
3620 PRINT STRING$(60, "-")
3630 PRINT "FIRST HALF MEAN     = "; MEAN1
3640 PRINT "SECOND HALF MEAN    = "; MEAN2
3650 PRINT "FIRST HALF VARIANCE = "; VAR1
3660 PRINT "SECOND HALF VARIANCE= "; VAR2
3670 PRINT STRING$(60, "-")
3680 IF ABS(MEAN2 - MEAN1) > .1 * ABS(MEAN1) THEN GOTO 3710   ' WARN IF MEAN SHIFT >10%
3690 IF VAR1 <> 0 THEN IF ABS(VAR2 - VAR1) > .2 * VAR1 THEN GOTO 3710   ' WARN IF VARIANCE SHIFT >20%
3700 GOTO 3720
3710 PRINT "WARNING: MEAN/VARIANCE SHIFT DETECTED! POSSIBLE NON-STATIONARITY!"
3720 PRINT
3730 INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$
3740 RETURN
3750 REM *** MAPE (MEAN ABSOLUTE PERCENTAGE ERROR) ***
3760 PRINT STRING$(79, "=")
3770 PRINT " MAPE (MEAN ABSOLUTE PERCENTAGE ERROR)"
3780 PRINT STRING$(79, "-")
3790 PRINT " THE MAPE MEASURES THE AVERAGE MAGNITUDE OF THE"
3800 PRINT " ERRORS AS A PERCENTAGE OF THE ACTUAL VALUES. IT"
3810 PRINT " IS CALCULATED AS:"
3820 PRINT
3830 PRINT "   MAPE = (100/N) * SUM(|(FORECASTI - ACTUALI) / ACTUALI|)"
3840 PRINT
3850 PRINT " WHERE:"
3860 PRINT "   N IS THE NUMBER OF FORECASTS"
3870 PRINT "   FORECASTI IS THE FORECASTED VALUE"
3880 PRINT "   ACTUALI IS THE ACTUAL VALUE"
3890 PRINT
3900 PRINT " USAGE: MAPE NORMALIZES THE ERRORS AS PERCENTAGES,"
3910 PRINT " FACILITATING COMPARISONS ACROSS DIFFERENT SCALES."
3920 PRINT STRING$(79, "-")
3930 PRINT STRING$(79, "=")
3940 PRINT
3950 INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$
3960 RETURN
3970 REM *** SUBROUTINE FOR COMPUTING FORECAST INTERVALS ***
3980 REM *** COMPUTE FORECAST INTERVALS ***
3990 RESVAR = SSE / N
4000 PHI = 1 - ALPHA
4010 FOR I = 1 TO H
4020 VARFACTOR = 0
4030 FOR J = 0 TO I - 1
4040 VARFACTOR = VARFACTOR + (PHI ^ (2 * J))
4050 NEXT J
4060 STDERR = SQR(RESVAR * VARFACTOR)
4070 ZVAL = 1.96  ' 95% CONFIDENCE
4080 U(N+I) = F(N+I) + ZVAL * STDERR
4090 L(N+I) = F(N+I) - ZVAL * STDERR
4100 NEXT I
4110 RETURN
4120 REM *** Y/N VALIDATION SUBROUTINE ***
4130 REM *** PROMPTS USER WITH PROMPT$, ACCEPTS ONLY Y/N (CASE-INSENSITIVE), REPEATS UNTIL VALID ***
4140 PRINT
4150 PRINT PROMPT$;
4160 INPUT ""; RESP$
4170 IF RESP$ = "" THEN PRINT "ENTER Y OR N.": GOTO 4150
4180 RESP$ = LEFT$(RESP$,1)
4190 IF RESP$ = "Y" OR RESP$ = "Y" THEN RESP$ = "Y": RETURN
4200 IF RESP$ = "N" OR RESP$ = "N" THEN RESP$ = "N": RETURN
4210 PRINT "INVALID INPUT. ENTER Y OR N.": GOTO 4150
4220 REM *** STATIONARITY CHECK EXPLANATION SUBROUTINE ***
4230 PRINT CHR$(26)
4240 PRINT STRING$(79, "=")
4250 PRINT "STATIONARITY CHECK EXPLANATION"
4260 PRINT STRING$(79, "-")
4270 PRINT "THE PROGRAM OPTIONALLY CHECKS FOR STATIONARITY BY COMPARING"
4280 PRINT "THE MEAN AND VARIANCE OF THE FIRST HALF AND SECOND HALF OF"
4290 PRINT "THE INPUT TIME SERIES."
4300 PRINT
4310 PRINT "A WARNING WILL BE ISSUED IF EITHER OF THE FOLLOWING IS TRUE:"
4320 PRINT " - THE ABSOLUTE DIFFERENCE IN MEANS EXCEEDS 10% OF THE"
4330 PRINT "   FIRST HALF'S MEAN."
4340 PRINT " - OR THE ABSOLUTE DIFFERENCE IN VARIANCES EXCEEDS 20% OF"
4350 PRINT "   THE FIRST HALF'S VARIANCE."
4360 PRINT
4370 PRINT "THIS INDICATES A SHIFT IN LEVEL OR SPREAD, SUGGESTING"
4380 PRINT "THE DATA MAY BE NON-STATIONARY, WHICH CAN REDUCE THE"
4390 PRINT "ACCURACY OF SIMPLE EXPONENTIAL SMOOTHING FORECASTS."
4400 PRINT STRING$(79, "-")
4410 INPUT "PRESS RETURN TO CONTINUE..."; DUMMY$
4420 RETURN
4430 REM *** STATISTICAL REPORT ***
4440 LPRINT STRING$(79, "=")
4450 LPRINT TAB(22); "STATISTICAL SUMMARY REPORT"
4460 LPRINT STRING$(79, "=")
4470 LPRINT "INPUT DATA POINTS: "; N; TAB(36); "FORECAST HORIZON: "; H
4480 LPRINT
4490 LPRINT "OPTIMAL ALPHA: "; ALPHA
4500 LPRINT "MEAN ABSOLUTE ERROR (MAE): "; MAE
4510 LPRINT "MEAN SQUARED ERROR (MSE): "; MSE
4520 LPRINT "ROOT MEAN SQUARED ERROR (RMSE): "; (MSE ^ .5)
4530 IF MAPE >= 0 THEN LPRINT "MEAN ABSOLUTE PERCENTAGE ERROR (MAPE): "; MAPE; "%" : GOTO 4550
4540 LPRINT "MEAN ABSOLUTE PERCENTAGE ERROR (MAPE): N/A"
4550 IF SMAPE >= 0 THEN LPRINT "SYMMETRIC MAPE (SMAPE): "; SMAPE; "%" : GOTO 4570
4560 LPRINT "SYMMETRIC MAPE (SMAPE): N/A"
4570 LPRINT
4580 LPRINT "MAPE INTERPRETATION:"
4590 IF MAPE < 0 THEN LPRINT "   N/A" : GOTO 4640
4600 IF MAPE < 10 THEN LPRINT "   HIGHLY ACCURATE FORECASTING" : GOTO 4640
4610 IF MAPE < 20 THEN LPRINT "   GOOD FORECASTING" : GOTO 4640
4620 IF MAPE < 50 THEN LPRINT "   REASONABLE FORECASTING" : GOTO 4640
4630 LPRINT "   INACCURATE FORECASTING"
4640 LPRINT
4650 LPRINT STRING$(79, "=")
4660 LPRINT TAB(10); "END OF REPORT"
4670 LPRINT STRING$(79, "=")
4680 RETURN
4690 REM *** PRINT PLOT ***
4700 REM *** DETERMINE Y-AXIS RANGE ***
4710 LPRINT "*******************************************************"
4720 LPRINT "TIME-SERIES FORECAST OUTPUT CHART – OPTIMIZED SMOOTHING"
4730 LPRINT "OPTIMAL ALPHA: "; ALPHA
4740 LPRINT "*******************************************************"
4750 LPRINT
4760 MAXY = -1E+30
4770 MINY = 1E+30
4780 FOR I = 1 TO N
4790 IF Y(I) > MAXY THEN MAXY = Y(I)
4800 IF Y(I) < MINY THEN MINY = Y(I)
4810 NEXT I
4820 FOR I = 1 TO H
4830 IF F(N+I) > MAXY THEN MAXY = F(N+I)
4840 IF F(N+I) < MINY THEN MINY = F(N+I)
4850 NEXT I
4860 RANGEY = MAXY - MINY
4870 IF RANGEY = 0 THEN RANGEY = 1
4880 REM *** CALCULATE SCALING ***
4890 MAXDISP = 40
4900 TOTALPTS = N + H
4910 SCALEF = INT(TOTALPTS / MAXDISP)
4920 IF SCALEF < 1 THEN SCALEF = 1
4930 LPRINT "PERIOD"; TAB(12); "PLOT"
4940 LPRINT STRING$(68, "-")
4950 FOR K = 1 TO TOTALPTS STEP SCALEF
4960 IF K <= N THEN GOTO 5000
4970 PLOTV = F(K)
4980 SYMBOL$ = "P"
4990 GOTO 5020
5000 PLOTV = Y(K)
5010 SYMBOL$ = "*"
5020 PLOTPOS = INT((PLOTV - MINY) / RANGEY * 60) + 12
5030 LPRINT K; TAB(PLOTPOS); SYMBOL$
5040 NEXT K
5050 LPRINT STRING$(68, "=")
5060 LPRINT "     *** END OF REPORT ***"
5070 RETURN
